"""Create rest api for Vulnerability."""

from django.db.models import Max
from rest_framework import serializers
from vulnerability.models import Vulnerability


class VulnerabilitySerializer(serializers.HyperlinkedModelSerializer):
    """."""

    hostname = serializers.CharField(max_length=32, read_only=True)
    ip_address = serializers.CharField(max_length=30, read_only=True)
    title = serializers.CharField(max_length=200, read_only=True)
    severity = serializers.CharField(max_length=15, read_only=True)
    cvss = serializers.FloatField(read_only=True)
    publication_date = serializers.DateField(read_only=True)
    status = serializers.BooleanField(read_only=False)

    class Meta:
        """."""

        model = Vulnerability
        fields = [
                  'hostname',
                  'ip_address',
                  'title',
                  'severity',
                  'cvss',
                  'publication_date',
                  'status'
                 ]
