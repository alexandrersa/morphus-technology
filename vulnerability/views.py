"""."""
from django.http import Http404
from vulnerability.models import Vulnerability
from vulnerability.serializers import VulnerabilitySerializer
from rest_framework import generics
from rest_framework.response import Response
from django_filters.rest_framework import DjangoFilterBackend
from rest_framework.filters import SearchFilter


class HostsViewSet(generics.ListAPIView):
    """
    API endpoint that allows users to be viewed or edited.
    """
    queryset = Vulnerability.objects.all()
    queryset = queryset.order_by('-cvss')
    serializer_class = VulnerabilitySerializer
    filter_backends = [DjangoFilterBackend, SearchFilter]
    filterset_fields = ['hostname', 'status']
    search_fields = ['title']


class HostViewSet(generics.ListAPIView):
    """
    API endpoint that allows users to be viewed or edited.
    """

    def get_object(self, pk):
        """."""
        try:
            return Vulnerability.objects.get(pk=pk)
        except Vulnerability.DoesNotExist:
            raise Http404
