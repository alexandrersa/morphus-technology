"""This script will import all vulnerabilities at Vulnerability database."""

import csv
from vulnerability.models import Vulnerability


def run():
    """Execute import data from csv file."""
    fhand = open('csv-data/asset_vulnerability.csv')
    reader = csv.reader(fhand)
    next(reader)
    try:
        Vulnerability.objects.all().delete()
    except Exception:
        pass

    for row in reader:
        if not row[4]:
            row[4] = None
        if not row[5]:
            row[5] = None

        Vulnerability.objects.create(
                                    hostname=row[0],
                                    ip_address=row[1],
                                    title=row[2],
                                    severity=row[3],
                                    cvss=row[4],
                                    publication_date=row[5],
                                    )
